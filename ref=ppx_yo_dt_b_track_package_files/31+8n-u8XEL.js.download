(function(e){var c=window.AmazonUIPageJS||window.P,p=c._namespace||c.attributeErrors,a=p?p("InTransitActionsBuzzAssets",""):c;a.guardFatal?a.guardFatal(e)(a,window):a.execute(function(){e(a,window)})})(function(e,c,p){"use strict";e.register("in-transit-csm-metrics-utils",function(){var a,f;try{a=navigator.userAgent}catch(b){a=""}a&&(a=a.toLowerCase(),(a=a.match(/(chrome|firefox|safari|trident|ddge|opr|crios|fxios)/gi))&&0<a.length&&(-1<a.indexOf("safari")&&1<a.length?-1<a.indexOf("chrome")||-1<a.indexOf("crios")?
f="chrome":-1<a.indexOf("fxios")&&(f="firefox"):f=a[0]));var d=[],n=function(b){c.ue&&c.uex&&uex("ld",b,{wb:1});b=d.indexOf(b);-1<b&&d.splice(b,1)};c.addEventListener("beforeunload",function(b){for(;0<d.length;)n(d[0])});return{setScope:function(b){c.ue&&c.uet&&c.uet("tc",b);return b},setPreAjax:function(b){c.ue&&c.ues&&c.ues("t0",b,new Date)},setPostAjax:function(b){c.ue&&c.uet&&c.uet("be",b)},sendAjaxMetrics:function(b){c.ue&&c.uex&&c.uex("ld",b)},recordReftag:function(b,c){b.ajax({type:"POST",
url:"/gp/mobile/tag?"+c,success:function(b){console.log("record ref tag ajax call success: ",b)},error:function(b){console.log("ref tag ajax call error: ",b)}})},logFatal:function(b){if(c.ueLogError){var a=b.feature||"pt2-fatal-generic";c.ueLogError(b.error||{message:b.message||a},{logLevel:"FATAL",attribution:a})}},logError:function(b){if(c.ueLogError){var a=b.feature||"pt2-error-generic";c.ueLogError(b.error||{message:b.message||a},{logLevel:"ERROR",attribution:a})}},logWarn:function(b){if(c.ueLogError){var a=
b.feature||"pt2-warn-generic";c.ueLogError(b.error||{message:b.message||a},{logLevel:"WARN",attribution:a})}},incrementCount:function(b,a){c.ue&&c.ue.count&&(c.ue.count(b,(c.ue.count(b)||0)+1),a&&a.browser&&f&&c.ue.count(b+"-"+f,(c.ue.count(b+"-"+f)||0)+1))},startWidgetTimer:function(b){c.ue&&c.uet&&0>d.indexOf(b)&&(uet("bb",b,{wb:1}),d.push(b))},stopWidgetTimer:n}});"use strict";e.when("A").register("in-transit-url-utils",function(a){function c(a){return a.split("\x26").reduce(function(b,a){a=a.split("\x3d").map(function(a){return decodeURIComponent(a.replace(/\+/g,
" "))});b[a[0]]=a[1];return b},{})}var d=a.$;return{getQueryParameterFromUrl:function(a,b){a=-1<a.indexOf("?")?a.substr(a.indexOf("?")):"";-1<a.indexOf("#")&&(a=a.substring(0,a.indexOf("#")));a=c(a);return a[b]?a[b]:!1},addQueryParameterToUrl:function(a,b){var c=!1;-1<a.indexOf("#")&&(c=a.substring(a.indexOf("#")),a=a.substr(0,a.indexOf("#")));b=d.param(b);a=-1<a.indexOf("?")?a+("\x26"+b):a+("?"+b);return c?a+c:a}}});"use strict";e.when("A","in-transit-csm-metrics-utils","ready").register("in-transit-sign-in-again-or-do",
function(a,f){var d=-1!==c.location.host.indexOf("hp-shoppingportal")?"/portal/cstrac/progress-tracker/actions/is-authenticated":"/progress-tracker/package/actions/is-authenticated",n;return function(b,f,e,g,h){a.post(d,{params:{csrfToken:g.csrfToken},success:function(a){a.success&&a.value?h&&h():a.success?(a=b.$currentTarget,g.width=620>c.innerWidth?.75*c.innerWidth:600,g.name=e,g.dataStrategy="preload",n||(n=f.create(a,g)),n.update({header:g.header||""}).show()):console.log("service failed")},error:function(a){}})}});
"use strict";e.when("A","in-transit-csm-metrics-utils","a-tooltip","ready").register("in-transit-tooltip",function(a,c,d){function n(a){c.incrementCount(a+"-total");g&&(c.incrementCount(a+"-unique"),g=!1)}function b(a){e("body").addClass("in-transit-tooltip-style-override "+q.deviceType);e(".in-transit-tooltip-trigger."+a).attr("title","")}var e=a.$,q=a.state("page-state")||{},g=!0,h=function(c){a.declarative("a-tooltip","mouseenter",function(a){b(c);n(c)});a.declarative("a-tooltip","click",function(a){a.$event.preventDefault()})},
k=function(c){a.declarative("a-tooltip","click",function(a){b(c);a=e(".in-transit-tooltip-trigger."+c);a=d.get(a);a.isVisible()?a.hide():n(c)})};return function(a){"desktop"!==q.deviceType&&q.deviceType?k(a):h(a)}});"use strict";e.when("A","a-modal","a-button","in-transit-url-utils","in-transit-csm-metrics-utils","ready").register("rescheduleDelivery",function(a,f,d,e,b){function y(){var a;a=r?0<g(".rescheduleWindowOption .a-button-selected").length?!0:!1:!0;a?t.enable():t.disable()}function q(){return"?"+
g.param({orderId:h.orderId,shipmentId:h.shipmentId,packageIndex:h.packageIndex})+"\x26amzlMessageId\x3d"}var g=a.$,h=a.state("page-state")||{},k=-1!==c.location.host.indexOf("hp-shoppingportal")?"/portal/cstrac/progress-tracker":"/progress-tracker/package",w=k+"/actions/in-transit/reschedule",p={isModalContent:"1"},x=q(),m=k+x,u=1==h.stringDebug,r="true"===g("#rescheduleDayOptions-container").attr("data-isRescheduleToWindow"),l,v=!1,t=d("#reschedule-submitBtn");a.declarative("intransit-reschedule-open-modal",
"click",function(b){b.$event.preventDefault();var d=b.$currentTarget;d.find("a").data("ref");b=a.extend({},b.data);b.width=620>c.innerWidth?.75*c.innerWidth:600;b.name="rescheduleModal";b.dataStrategy="ajax";"#"===d.find("a").attr("href")?b.url=d.find("a").attr("data-modalurl"):b.url=d.find("a").attr("href");b.url=e.addQueryParameterToUrl(b.url,p);f.create(d,b).show()});a.on("a:popover:ajaxContentLoaded:rescheduleModal",function(b){a.state.parse();h=a.state("page-state")||{};x=q();m=k+x;u=1==h.stringDebug;
r="true"===g("#rescheduleDayOptions-container").attr("data-isRescheduleToWindow");t=d("#reschedule-submitBtn")});a.on("a:button-group:toggleRescheduleDayOption:toggle",function(a){a=a.selectedButton.buttonName;if(0<a.length){a=a.split("_");a=g("#rescheduleDeliveryWindowsGroup_"+(1<a.length?a[1]:"INVALID"));if(r){var c=g(".rescheduleWindowOption .a-button-selected");g(".rescheduleDeliveryWindowsGroup").addClass("invisible");c.removeClass("a-button-selected");c.attr("aria-checked","false");0<a.length?
a.removeClass("invisible"):console.log("No matching window group found for the day option selected")}else l=a.find(".rescheduleWindowOption").first().find(".a-button-input").data("token"),v=!0,"undefined"===typeof l&&(b.logError({feature:"request-reschedule-ajax-call-day-toggle-token-not-set",message:"The reschedule token was not set while toggling day"}),b.incrementCount("request-reschedule-ajax-call-day-toggle-token-not-set"));y()}});a.on("a:button-group:toggleRescheduleWindowOption:toggle",function(a){y()});
a.declarative("submit-reschedule","click",function(d){d.$event.preventDefault();t.disable();r&&(l=g(".rescheduleWindowOption .a-button-selected").find(".a-button-input").data("token"),v=!0);"undefined"!==typeof l&&"undefined"!==l||!r?"undefined"!==typeof l&&"undefined"!==l||!1!==v?a.post(w,{params:{rescheduleToken:l,stringDebug:u,csrfToken:c.csrfToken},dataType:"json",success:function(a){var d=a.requestRescheduleDisplayResponse;if(a.success)b.incrementCount("request-reschedule-ajax-call-success"),
c.location=m+"7";else{b.incrementCount("request-reschedule-ajax-call-failure");var d=(d=d.failureReason)||0,t="";d&&(t=", failureReason: "+d);b.logError({feature:"request-reschedule-ajax-call-failure-log",message:"Failed to request reschedule due to responseCode: "+a.responseCode+t});c.location=m+"8"}},error:function(a){b.incrementCount("request-reschedule-ajax-call-error");b.logError({feature:"request-reschedule-ajax-call-error-log",message:("Error making a request to reschedule with",a)});c.location=
m+"8"}}):(b.logError({feature:"request-reschedule-ajax-call-token-never-attempted-to-set",message:("The reschedule token was never attempted to set before making a reschedule request for ",data)}),b.incrementCount("request-reschedule-ajax-call-token-never-attempted-to-set"),c.location=m+"8"):(b.logError({feature:"request-reschedule-ajax-call-window-toggle-token-not-set",message:"The reschedule token was not set while toggling window"}),b.incrementCount("request-reschedule-ajax-call-window-toggle-token-not-set"),
c.location=m+"8")})});"use strict";e.when("A","in-transit-url-utils","rescheduleDelivery","inTransitPackageCancellation","ready").execute("in-transit-loaded",function(a,f){var d=["PackageProgressTracker"];"desktop"===(a.state("page-state")||{}).deviceType&&(f=f.getQueryParameterFromUrl(c.location.search||c.location.href,"showModal"))&&-1<d.indexOf(c.uept.pageType||"")&&(d=f.replace(/[^0-9a-z\-\_]/gi,""),a=a.$("[data-action\x3d"+d+"]"),1===a.length&&a.click())});"use strict";e.when("A","mash","page-load").execute(function(a,
f){var d=document.getElementById("redirectToPickupPointCTA");d&&(d.onclick=function(){try{return f.navstack.begin().modalOpen(d.href).end(),!1}catch(a){console.log(a)}},c.addEventListener("popstate",function(){if(!c.location.href.includes("location-selector"))try{f.navstack.begin().modalClose().end()}catch(a){console.log(a)}}))});"use strict";e.when("A","a-modal","a-button","in-transit-url-utils","in-transit-csm-metrics-utils","ready").register("inTransitPackageCancellation",function(a,f,d,e,b){function p(){a.state.parse();
k=a.state("page-state")||{};m=g();u=w+m;r=1==k.stringDebug;q()}function q(){h(".cancel-go-back").click(function(){c.history&&"function"===typeof c.history.back&&c.history.back()})}function g(){return"?"+h.param({orderId:k.orderId,shipmentId:k.shipmentId,packageIndex:k.packageIndex})+"\x26amzlMessageId\x3d"}var h=a.$,k=a.state("page-state")||{},w=-1!==c.location.host.indexOf("hp-shoppingportal")?"/portal/cstrac/progress-tracker":"/progress-tracker/package",z=w+"/actions/in-transit/cancel",x={isModalContent:"1"},
m=g(),u=w+m,r=1==k.stringDebug,l,v;a.declarative("intransit-cancel-open-modal","click",function(b){b.$event.preventDefault();var d=b.$currentTarget;d.find("a").data("ref");b=a.extend({},b.data);b.width=620>c.innerWidth?.75*c.innerWidth:600;b.name="cancelModal";b.dataStrategy="ajax";"#"===d.find("a").attr("href")?b.url=d.find("a").attr("data-modalurl"):b.url=d.find("a").attr("href");b.url=e.addQueryParameterToUrl(b.url,x);f.create(d,b).show()});p();a.on("a:popover:ajaxContentLoaded:cancelModal",p);
a.declarative("submit-intransit-cancel","click",function(d){d.$event.preventDefault();var e=document.getElementById("cancel-modal-data").dataset;d=e.deviceType;var g=e.isApp,e={orderId:e.orderId,shipmentId:e.shipmentId,packageId:e.packageIndex,stringDebug:r,deviceType:d,isApp:g,csrfToken:c.csrfToken};l="desktop"===d?"dt_":"mob_";v=g?"ap_":"b_";var f="\x26ref\x3dppx_pt2_"+l+v+"cancel_deli_submit";a.post(z,{params:e,dataType:"json",success:function(a){var d=a.requestPackageCancellationDisplayResponse;
if(a.success)b.incrementCount("request-intransit-cancel-ajax-call-success"),c.location=u+"15"+f;else{b.incrementCount("request-intransit-cancel-ajax-call-failure");var d=(d=d.displayableCancelMessage)||0,e="";d&&(e=", failureReason: "+d);b.logError({feature:"request-intransit-cancel-ajax-call-failure-log",message:"Failed to request package cancellation due to responseCode: "+a.responseCode+e});c.location=u+"6"+f}},error:function(a){b.incrementCount("request-intransit-cancel-ajax-call-error");b.logError({feature:"request-intransit-cancel-ajax-call-failure-log",
message:("Error making a request to package cancellation with",a)});c.location=u+"6"+f}})})})});